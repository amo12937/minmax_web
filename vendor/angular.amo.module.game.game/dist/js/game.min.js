/*! angular.amo.module.game.game 1.1.0 | Copyright (c) 2015 Author: amo | License: MIT */(function(){"use strict";var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};!function(a){return angular.module(a,["ng","amo.module.state_machine"]).factory(""+a+".GameFsm",["amo.module.state_machine.StateSetter",function(a){return function(c){var d,e,f,g,h,i;return i=a(),e=function(){function a(){}return a.prototype.Entry=i.defaultAction,a.prototype.Exit=i.defaultAction,a.prototype.start=i.defaultAction,a.prototype.finish=i.defaultAction,a.prototype.stop=i.defaultAction,a.prototype.isInit=function(){return!1},a.prototype.isPlaying=function(){return!1},a.prototype.isDone=function(){return!1},a.prototype.isStopped=function(){return!1},a}(),f=new(function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.start=function(){return i(g)},c.prototype.stop=function(){return i(h)},c.prototype.isInit=function(){return!0},c}(e)),g=new(function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.Entry=function(){return c.startToPlay()},e.prototype.Exit=function(){return c.finishPlaying()},e.prototype.finish=function(a){return i(a?d:g)},e.prototype.stop=function(){return i(h)},e.prototype.isPlaying=function(){return!0},e}(e)),d=new(function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.Entry=function(){return c.entryDone()},d.prototype.isDone=function(){return!0},d}(e)),h=new(function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.Entry=function(){return c.entryStopped()},d.prototype.isStopped=function(){return!0},d}(e)),i.getFsm(f)}}]).factory(""+a+".Game",["$timeout","$q",""+a+".GameFsm",function(a,b,c){return function(d){var e,f,g,h;return h=function(){var a,c,d;return a=b.defer(),c=a.promise,a.resolve(),d={add:function(a){return c=c.then(a),d}}}(),f=null,e=c({startToPlay:function(){var b;return"function"==typeof d.notifyStartingToPlay&&d.notifyStartingToPlay(),b=d.getNextPlayer(),a(function(){return h.add(function(){return b.play()}).add(function(a){f?f.promise.then(function(){return e().finish(a)}):e().finish(a)})})},finishPlaying:function(){return"function"==typeof d.notifyFinishedPlaying?d.notifyFinishedPlaying():void 0},entryDone:function(){return"function"==typeof d.end?d.end():void 0},entryStopped:function(){return"function"==typeof d.stop?d.stop():void 0}}),g={start:function(){return e().start()},pause:function(){return e().isPlaying()&&!f?(f=b.defer(),"function"==typeof d.notifyPausing?d.notifyPausing():void 0):void 0},resume:function(){return f?("function"==typeof d.notifyResuming&&d.notifyResuming(),f.resolve(),f=null):void 0},paused:function(){return!!f},stop:function(){return e().stop()}}}}])}("amo.module.game.game")}).call(this);